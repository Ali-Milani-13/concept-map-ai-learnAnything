name: Next.js CI Pipeline

# 1. When should this action run?
on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]

# 2. What should it do?
jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      # A. Grab your code from the repository
      - name: Checkout Code
        uses: actions/checkout@v4

      # B. Set up the Node.js environment
      - name: Setup Node.js 18.x
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm' # Automatically caches dependencies to speed up future runs

      # C. Install dependencies (npm ci is a strict version of npm install for automated environments)
      - name: Install Dependencies
        run: npm ci

      # D. Run the Next.js linter to catch syntax or rule errors
      - name: Run Linter
        run: npm run lint

      # E. Attempt a full production build
      - name: Build Application
        run: npm run build